
<!-- Extending the predefined project layout -->
{% extends "layouts/base.html" %}

<!- This variable sets name of browser tab  -->
{% set project = "Play Game: Tetris" %}

<!- This is a replacement block for Body in base.html -->
{% block body %}
    <!- Try building a new body here, bootstrap is a wise choice ->
    <!DOCTYPE html>
    <html>
        <head>
            <a charset="utf-8">
            <title>Tetris</title>
            <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='css/tetris.css')}}">
        </head>
        <center>
        <body> <!-- id and class refer to code built in the static/js/tetris.js file by Backend Developer-->
            <!-- <button onclick="myFunction()">Click here to end the game</button>-->
            <button class="button button1" onclick="helpFunction()">How to play</button>
            <button class="button button2" onclick="api()">info</button>

            <div id="gameField">
                <div id="gameover">
                    <center> <!--puts the text in the center-->
                        <h1>Game Over</h1> <!--bigger the number with h, larger the font size-->
                        <h4>press 'F5' to restart</h4>
                    </center>
                </div>
                <div id="pause">
                    <center>
                        <h1>Game Paused</h1>
                        <h4>press 'P' to resume</h4>
                        <h4>press 'F5' to restart</h4>
                    </center>
                </div>
                <table id="nextTable" border=0> 
                    <tr><td id="00"></td><td id="01"></td><td id="02"></td><td id="03"></td></tr>
                    <tr><td id="10"></td><td id="11"></td><td id="12"></td><td id="13"></td></tr>
                    <tr><td id="20"></td><td id="21"></td><td id="22"></td><td id="23"></td></tr>
                    <tr><td id="30"></td><td id="31"></td><td id="32"></td><td id="33"></td></tr>
                </table>
                <div id="scoreField">
                    <center>
                    <p class="sub">LEVEL</p>
                    <p id="level">1</p>
                    <p class="sub">SCORE</p>
                    <p id="score">0</p>
                    <p class="sub">NEXT</p>
                    <p><br><br><br></p>
                    <p class="sub">HELP</p>
                    <p id="help">← ↓ →</p>
                    <p id="help">Space Bar to rotate</p><br>
                    <p id="help">'P' to pause</p>
                    <p id="help">'q' to change shape</p>
                    <div id="comboField"><i></i></div>
                    </center>
                </div>
                </center>
                <script type="text/javascript" src="{{url_for('static',filename='js/tetris.js')}}"></script>
                <script>
                    function myFunction() {
                        if(!isPaused){
                            gameOver();
                        }
                        if(isPaused) {
                            alert("you cannot end the game on the pause screen");
                        }
                    } 
               
                    function helpFunction() {
                        alert("Clear lines with the falling pieces to score! Just create lines with the falling pieces and don't let the blocks reach the top or you lose!")
                    }
                </script>
                
                <script>

                    function testButtonClick(city) {
                        
                        if (!city.trim()) {
                            alert("Enter a city.");
                            return;
                        }  
                
                //alert("yo momma!:  " + city);
                
                        // prepare HTML result container for new output
                        const resultContainer = document.getElementById("astronomy");
                
                        //clear contents of astronomy table
                        resultContainer.innerHTML = "";
                
                //alert("1: " + resultContainer);
                
                        // prepare fetch options
                        const url = "https://weatherapi-com.p.rapidapi.com/astronomy.json?q=" + city; 
                                        
                //alert("2: " + url);
                            
                        const headers = {
                            method: 'GET', // *GET, POST, PUT, DELETE, etc.
                            mode: 'cors', // no-cors, *cors, same-origin
                            cache: 'default', // *default, no-cache, reload, force-cache, only-if-cached
                            credentials: 'omit', // include, *same-origin, omit
                            headers: {
                                'Content-Type': 'application/json',
                                'X-RapidAPI-Key': '0b6ef107f7msh5606de624633ceap17521ejsn27566d20ff5b',
                                'X-RapidAPI-Host': 'weatherapi-com.p.rapidapi.com'
                            },
                        };
                
                //alert("3: " + headers)
                
                //alert("3a: pre-fetch" + headers);
                
                        // fetch the API
                        fetch(url, headers)
                        // response is a RESTful "promise" on any successful fetch
                        .then(response => {
                            // check for response errors
                            if (response.status !== 200) {
                
                                const errorMsg = 'Database response error: ' + response.status;
                                console.log(errorMsg);
                                const tr = document.createElement("tr");
                                const td = document.createElement("td");
                                td.innerHTML = errorMsg;
                                tr.appendChild(td);
                                resultContainer.appendChild(tr);
                
                                return;
                            }
                            // valid response will have json data
                            response.json().then(data => {
                                console.log(data);
                                console.log(data.location)
                
                                // World Data
                                document.getElementById("name").innerHTML = data.location.name;
                                document.getElementById("region").innerHTML = data.location.region;
                                document.getElementById("country").innerHTML = data.location.country;
                                document.getElementById("lat").innerHTML = data.location.lat;
                                document.getElementById("lon").innerHTML = data.location.lon;
                                document.getElementById("tz_id").innerHTML = data.location.tz_id;
                                document.getElementById("localtime_epoch").innerHTML = data.location.localtime_epoch;
                                document.getElementById("localtime").innerHTML = data.location.localtime;
                
                                //alert("data.astronomy" + data.astronomy.astro.sunrise);
                                // tr for each row
                                const tr = document.createElement("tr");
                
                                // td for each column
                                const sunrise = document.createElement("td");
                                const sunset = document.createElement("td");
                                const moonrise = document.createElement("td");
                                const moonset = document.createElement("td");
                                const moon_phase = document.createElement("td");
                                const moon_illumination = document.createElement("td");
                
                                // data is specific to the API
                                sunrise.innerHTML = data.astronomy.astro.sunrise;
                                sunset.innerHTML = data.astronomy.astro.sunset; 
                                moonrise.innerHTML = data.astronomy.astro.moonrise; 
                                moonset.innerHTML = data.astronomy.astro.moonset; 
                                moon_phase.innerHTML = data.astronomy.astro.moon_phase; 
                                moon_illumination.innerHTML = data.astronomy.astro.moon_illumination; 
                
                                // this builds td's into tr
                                tr.appendChild(sunrise);
                                tr.appendChild(sunset);
                                tr.appendChild(moonrise);
                                tr.appendChild(moonset);
                                tr.appendChild(moon_phase);
                                tr.appendChild(moon_illumination);
                
                                // add HTML to container
                                resultContainer.appendChild(tr);
                            })
                        })
                
                //alert("4: post fetch");
                
                    }
                
                
                </script>

                <center>
                <body>
                
                <h1 style="color:white">City Astronomy and Location API</h1>                
                
                <!-- HTML table fragment for page -->
                
                
                <p style="color:white" If you choose a city, it will list out the location and astronomy details.></p>
                            
                
                <label style="color:white" for="city">Enter city name:</label>
                <input type="text" id="city" name="city">&nbsp;&nbsp;<input type="button" value="Get Location & Astronomy" onclick="testButtonClick(document.getElementById('city').value)">
                <br><br>
                
                <center>
                <table>
                  <thead style="color:white">Location Details 
                  <tr>
                    <th style="color:white">City</th>
                    <th style="color:white">Region</th>
                    <th style="color:white">Country</th>
                    <th style="color:white">Latitude</th>
                    <th style="color:white">Longitude</th>
                    <th style="color:white">Time Zone</th>
                    <th style="color:white">Local Time Epoch</th>
                    <th style="color:white">Local Date and Time</th>
                  </tr>
                  </thead>
                  <tbody>
                    <td style="color:white"id="name"></td>
                    <td style="color:white" id="region"></td>
                    <td style="color:white" id="country"></td>
                    <td style="color:white"id="lat"></td>
                    <td style="color:white" id="lon"></td>
                    <td style="color:white" id="tz_id"></td>
                    <td style="color:white" id="localtime_epoch"></td>
                    <td style="color:white"id="localtime"></td>
                  </tbody>
                </table>
                </center>               
                
                </center>
                <table>
                    <thead style="color:white">Astronomy Details
                    <tr style="color:white">
                        <th style="color:white">Sunrise</th>
                        <th style="color:white">Sunset</th>
                        <th style="color:white">Moonrise</th>
                        <th style="color:white">Moonset</th>
                        <th style="color:white">Moon Phase</th>
                        <th style="color:white">Moon Illumination</th>
                    </tr>
                    </thead>
                    <tbody style="color:white" id="astronomy">
                        <!-- generated rows -->
                    </tbody>
                    <style>
                        table, th, td {
                    border: 1px solid rgb(236, 224, 224);
                    padding: 15px;
                    }
                    </style>
                </center>
                </table>    
                </center>

                <script>
                    var x = 0;
                    var array = Array();
    
                    function add_score_to_array(){
                        array[x] = document.getElementById("text1").value;
                        alert("Player Name: " + array[x] + " Added to the scoreboard" );
                        x++;
                        document.getElementById("text1").value = "";
                    }
    
                    function display_array(){
                        alert(playerFinalScore);
                        var e = "<hr/>";   
                        for (var y=0; y<array.length; y++)
                        {
                            e += "Player " + array[y] + " Score: " +  playerFinalScore + "<br/>";
                        }
                        document.getElementById("Result").innerHTML = e;
                    }

                    //let Scoreboard = {
                            //name: x,
                            //score: comboScore
                        //}

                    //function Scoreboard(){
                        //const finalScore = [];
                        //finalScore.sort(function(a, b){return b - a});

                    //} 
                </script>
                <!--output of scoreboard-->
                <!-- <html>
                    <head>
                        <style>
                            table, th, td {
                              border: 1px solid black;
                            }
                            th, td {
                                padding: 15px;
                                border: 1px solid black;
                            }
                
                        </style>
                    <meta charset=utf-8 />
                    <title>Tetris Scoreboard</title>
                    <style>
                    body {padding-top:50px} 
                    </style> 
                    </head>
                    <body>
                    <input type="text" id="name"></input>
                    <input type="text" id="score"></input>
                    <input type="button" id="button1" value="Enter" onclick="add_element_to_array();"></input>
                    <input type="button" id="button2" value="View Scoreboard" onclick="display_array();"></input>
                    <div id="Result"></div> 
                    </body>
                </html>

                <script>
                    var arrayScoreboard = [];

                    var x = document.getElementById("audio");
                    function playAudio() {
                        x.play();
                    }
                    function pauseAudio() {
                        x.pause();
                    }
                    

                </script>

                <audio id="audio" autoplay hidden controls loop>
                    <source src="/static/assets/Tetris.mp3" type="audio/mpeg" loop="true">
                </audio>
                
            </body>

<!-< !!!!!JUSTIN API BACKUP CODE!!!! <script>function api() {const options = {
	method: 'GET',
	headers: {
		'X-RapidAPI-Key': '6a13c0a609mshb8a55b62f42e6d0p15ec9ejsnaf557400ec31',
		'X-RapidAPI-Host': 'contextualwebsearch-websearch-v1.p.rapidapi.com'
	}
};

fetch('https://contextualwebsearch-websearch-v1.p.rapidapi.com/api/Search/ImageSearchAPI?q=tetris&pageNumber=1&pageSize=10&autoCorrect=true', options)
	.then(response => response.json())
	.then(response => console.log(response))
	.catch(err => console.error(err));
    document.getElementById("test").innerHTML = JSON.stringify(Array(10), null, 2);
    


}</script> -->


       
    </html>

   <!--
    <script>
        var playerName = prompt("Please enter your name", "<name>");
            if (playerName!= null) {
         document.getElementById("welcome").innerHTML = "Hello " + customerName + "! How are you today?";

            }
         
    </script> 
    -->

   <!-- <div class="px-5 py-5 mx-auto">Here we will start building!</div>
    <head>
        <title>Our Game</title>
    </head>
    <style>
        .button {
          border: none;
          color: white;
          padding: 15px 30px;
          text-align: center;
          text-decoration-style: darkviolet;
          display: inline-table;
          font-size: 26px;
          margin: 6px 4px;
          cursor: pointer;
        }
        .button1 {background-color: #790cb4;}
        .button2 {background-color: #790cb4;} /* Purple */
        .button3 {background-color: #790cb4;}
    </style>        
      <body>
        <button class="button button2">Play</button>
        <button class="button button1" onclick="myFunction()">How to play</button>
        <button class="button button3" onclick="Scoreboard()">View Scoreboard</button>
        <p id="play"></p>
        <div id="rules">
            Use up arrow to rotate the block. Use left and right arrow to move the block horizontally. Use the down arrow to speed up the drop of the block. Use the space block to hard drop the block all the way down.
            </div>
        <script>
            function myFunction() {
                document.getElementById("rules").innerHTML = "Use up arrow to rotate the block. Use left and right arrow to move the block horizontally. Use the down arrow to speed up the drop of the block. Use the space block to hard drop the block all the way down.";
                var x = document.getElementById("rules");
                    if (x.style.display === "none") {
                        x.style.display = "block";
                    } else {
                        x.style.display = "none";
                    }
            }
        
        </script>

      </body> -->

    
{% endblock %} 

<!- This is turning off birds background from base.html -->
{% block background %}
{% endblock %}